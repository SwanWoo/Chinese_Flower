# CycleGAN å¾®è°ƒæ¨¡å—

æœ¬æ¨¡å—æä¾›äº†åŸºäºé¢„è®­ç»ƒæ¨¡å‹çš„ CycleGAN å¾®è°ƒåŠŸèƒ½ï¼Œæ”¯æŒä» `checkpoints/first/latest_net_G.pth` åŠ è½½é¢„è®­ç»ƒæƒé‡è¿›è¡Œè¿›ä¸€æ­¥è®­ç»ƒã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… ä»é¢„è®­ç»ƒæ¨¡å‹åŠ è½½æƒé‡
- âœ… TensorBoard å¯è§†åŒ–ç›‘æ§
- âœ… æ•°æ®å¢å¼ºæ”¯æŒ
- âœ… çµæ´»çš„é…ç½®é€‰é¡¹
- âœ… å®æ—¶æŸå¤±ç›‘æ§
- âœ… æ¨¡å‹æ£€æŸ¥ç‚¹ä¿å­˜

## æ–‡ä»¶ç»“æ„

```
CycleGAN/finetune/
â”œâ”€â”€ __init__.py              # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ finetune_config.py       # å¾®è°ƒé…ç½®
â”œâ”€â”€ data_augmentation.py     # æ•°æ®å¢å¼º
â”œâ”€â”€ tensorboard_logger.py    # TensorBoard æ—¥å¿—
â”œâ”€â”€ finetune_model.py        # å¾®è°ƒæ¨¡å‹
â”œâ”€â”€ finetune_train.py        # å¾®è°ƒè®­ç»ƒè„šæœ¬
â””â”€â”€ README.md               # è¯´æ˜æ–‡æ¡£
```

## å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡æ•°æ®é›†

åˆ›å»ºå¾®è°ƒæ•°æ®é›†ç›®å½•ï¼Œæ ¼å¼ä¸åŸå§‹ CycleGAN ç›¸åŒï¼š

```
datasets/chinesepainting_finetune/
â”œâ”€â”€ trainA/    # æºåŸŸå›¾åƒ
â””â”€â”€ trainB/    # ç›®æ ‡åŸŸå›¾åƒ
```

### 2. è¿è¡Œå¾®è°ƒè®­ç»ƒ

```bash
python CycleGAN/finetune/finetune_train.py \
    --dataroot ./datasets/chinesepainting_finetune \
    --pretrained_path ./checkpoints/first/latest_net_G.pth \
    --n_epochs 100 \
    --n_epochs_decay 100 \
    --lr 0.0002 \
    --batch_size 1 \
    --name chinesepainting_finetune \
    --gpu_ids 0
```

### 3. ç›‘æ§è®­ç»ƒè¿‡ç¨‹

å¯åŠ¨ TensorBoard æŸ¥çœ‹è®­ç»ƒè¿›åº¦ï¼š

```bash
tensorboard --logdir=./checkpoints/finetune/tensorboard
```

## é…ç½®é€‰é¡¹

### æ•°æ®ç›¸å…³å‚æ•°
- `--dataroot`: æ•°æ®é›†ç›®å½•è·¯å¾„
- `--load_size`: å›¾åƒåŠ è½½å°ºå¯¸ (é»˜è®¤: 286)
- `--crop_size`: å›¾åƒè£å‰ªå°ºå¯¸ (é»˜è®¤: 256)
- `--batch_size`: æ‰¹å¤§å° (é»˜è®¤: 1)

### è®­ç»ƒç›¸å…³å‚æ•°
- `--n_epochs`: è®­ç»ƒè½®æ•° (é»˜è®¤: 100)
- `--n_epochs_decay`: å­¦ä¹ ç‡è¡°å‡è½®æ•° (é»˜è®¤: 100)
- `--lr`: å­¦ä¹ ç‡ (é»˜è®¤: 0.0002)

### æ¨¡å‹ç›¸å…³å‚æ•°
- `--pretrained_path`: é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„
- `--checkpoints_dir`: æ£€æŸ¥ç‚¹ä¿å­˜ç›®å½•
- `--name`: å®éªŒåç§°

### è®¾å¤‡å‚æ•°
- `--gpu_ids`: GPU ID (é»˜è®¤: '0', '-1' è¡¨ç¤ºä½¿ç”¨ CPU)

### æ—¥å¿—å‚æ•°
- `--print_freq`: æ‰“å°é¢‘ç‡ (é»˜è®¤: 100)
- `--save_epoch_freq`: ä¿å­˜é¢‘ç‡ (é»˜è®¤: 1)
- `--no_tensorboard`: ç¦ç”¨ TensorBoard
- `--no_data_aug`: ç¦ç”¨æ•°æ®å¢å¼º

## æ•°æ®å¢å¼º

å¾®è°ƒæ¨¡å—æ”¯æŒä»¥ä¸‹æ•°æ®å¢å¼ºæŠ€æœ¯ï¼š

1. **éšæœºè£å‰ª**: å¢å¼ºç©ºé—´ä¸å˜æ€§
2. **æ°´å¹³ç¿»è½¬**: å¢åŠ æ•°æ®å¤šæ ·æ€§
3. **é¢œè‰²æŠ–åŠ¨**: è°ƒæ•´äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦ã€è‰²è°ƒ
4. **é«˜æ–¯å™ªå£°**: å¢åŠ æ¨¡å‹é²æ£’æ€§

## TensorBoard ç›‘æ§

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šè®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š

### æ ‡é‡æ•°æ®
- GAN æŸå¤± (G_A, G_B, D_A, D_B)
- å¾ªç¯ä¸€è‡´æ€§æŸå¤± (cycle_A, cycle_B)
- èº«ä»½æŸå¤± (idt_A, idt_B)
- å­¦ä¹ ç‡å˜åŒ–
- è®­ç»ƒæ—¶é—´

### å›¾åƒæ•°æ®
- æ¯ 10 ä¸ª epoch è®°å½•ä¸€æ¬¡ç”Ÿæˆå›¾åƒ
- æºåŸŸå’Œç›®æ ‡åŸŸå›¾åƒå¯¹æ¯”

### ç»Ÿè®¡ä¿¡æ¯
- æ¢¯åº¦èŒƒæ•°
- å‚æ•°ç»Ÿè®¡

## æ¨¡å‹ç‰¹æ€§

### é¢„è®­ç»ƒæƒé‡åŠ è½½
- è‡ªåŠ¨ä»æŒ‡å®šè·¯å¾„åŠ è½½é¢„è®­ç»ƒç”Ÿæˆå™¨æƒé‡
- å¯é€‰åŠ è½½åˆ¤åˆ«å™¨æƒé‡
- æ”¯æŒæ¨¡å‹å…¼å®¹æ€§æ£€æŸ¥

### çµæ´»çš„è®­ç»ƒé…ç½®
- å¯å†»ç»“ç‰¹å®šå±‚
- æ”¯æŒä¸åŒçš„ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨å­¦ä¹ ç‡
- æ¢¯åº¦ç´¯ç§¯æ”¯æŒ

### æ¨¡å‹åˆ†æ
- å‚æ•°æ•°é‡ç»Ÿè®¡
- å±‚å†»ç»“/è§£å†»åŠŸèƒ½
- å­¦ä¹ ç‡åŠ¨æ€è°ƒæ•´

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬å¾®è°ƒ
```bash
python finetune_train.py --dataroot ./my_dataset --pretrained_path ./pretrained/model.pth
```

### è‡ªå®šä¹‰è®­ç»ƒå‚æ•°
```bash
python finetune_train.py \
    --dataroot ./datasets/my_finetune \
    --pretrained_path ./checkpoints/pretrained/latest_net_G.pth \
    --n_epochs 50 \
    --n_epochs_decay 50 \
    --lr 0.0001 \
    --batch_size 2 \
    --name my_finetune_experiment \
    --gpu_ids 0,1
```

### ç¦ç”¨ç‰¹å®šåŠŸèƒ½
```bash
python finetune_train.py \
    --no_tensorboard \    # ç¦ç”¨ TensorBoard
    --no_data_aug        # ç¦ç”¨æ•°æ®å¢å¼º
```

## æ³¨æ„äº‹é¡¹

1. **æ•°æ®é›†æ ¼å¼**: ç¡®ä¿æ•°æ®é›†ç›®å½•åŒ…å« `trainA` å’Œ `trainB` æ–‡ä»¶å¤¹
2. **é¢„è®­ç»ƒæ¨¡å‹**: æ£€æŸ¥é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„æ˜¯å¦æ­£ç¡®
3. **GPU å†…å­˜**: æ ¹æ® GPU å†…å­˜è°ƒæ•´æ‰¹å¤§å°
4. **è®­ç»ƒæ—¶é—´**: å¾®è°ƒé€šå¸¸æ¯”ä»å¤´è®­ç»ƒå¿«å¾ˆå¤š
5. **ç›‘æ§**: å»ºè®®ä½¿ç”¨ TensorBoard å®æ—¶ç›‘æ§è®­ç»ƒè¿‡ç¨‹

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **é¢„è®­ç»ƒæ¨¡å‹åŠ è½½å¤±è´¥**
   - æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   - ç¡®ä¿æ¨¡å‹æ ¼å¼å…¼å®¹

2. **å†…å­˜ä¸è¶³**
   - å‡å°æ‰¹å¤§å°
   - ä½¿ç”¨æ›´å°çš„å›¾åƒå°ºå¯¸

3. **TensorBoard æ— æ³•å¯åŠ¨**
   - æ£€æŸ¥ tensorboard æ˜¯å¦å®‰è£…: `pip install tensorboard`

4. **è®­ç»ƒä¸æ”¶æ•›**
   - è°ƒæ•´å­¦ä¹ ç‡
   - æ£€æŸ¥æ•°æ®è´¨é‡

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. ä¾èµ–åŒ…æ˜¯å¦å®Œæ•´å®‰è£…
2. æ•°æ®é›†æ ¼å¼æ˜¯å¦æ­£ç¡®
3. é¢„è®­ç»ƒæ¨¡å‹æ˜¯å¦å…¼å®¹

## ç‰ˆæœ¬å†å²

- v1.0.0: åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºæœ¬å¾®è°ƒåŠŸèƒ½
- æ”¯æŒé¢„è®­ç»ƒæ¨¡å‹åŠ è½½
- é›†æˆ TensorBoard å¯è§†åŒ–
- æ•°æ®å¢å¼ºæ”¯æŒ

---

**Happy Fine-tuning!** ğŸ¨
